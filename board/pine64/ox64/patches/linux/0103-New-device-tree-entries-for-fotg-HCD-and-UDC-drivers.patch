From 7db4088981e2378d8cf3063ba95b6c177304ae27 Mon Sep 17 00:00:00 2001
From: "Grant T. Olson" <kgo@grant-olson.net>
Date: Sun, 19 Feb 2023 15:29:34 -0500
Subject: [PATCH 103/104] New device tree entries for fotg HCD and UDC drivers.

---
 .../boot/dts/bouffalolab/bl808-pine64-ox64.dts     |  2 +-
 .../boot/dts/bouffalolab/bl808-sipeed-m1s.dts      |  2 +-
 arch/riscv/boot/dts/bouffalolab/bl808.dtsi         | 14 ++++++++++++--
 3 files changed, 14 insertions(+), 4 deletions(-)

diff --git a/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts b/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts
index 420d3e40e3f4..8f4a3a7896b4 100644
--- a/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts
+++ b/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts
@@ -63,7 +63,7 @@ &ipclic {
 	status = "okay";
 };
 
-&ehci0 {
+&usb1 {
 	status = "okay";
 };
 
diff --git a/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts b/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts
index 155ebdbfc411..d42f4d2651c9 100644
--- a/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts
+++ b/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts
@@ -73,7 +73,7 @@ &ipclic {
 	status = "okay";
 };
 
-&ehci0 {
+&usb1 {
 	status = "okay";
 };
 
diff --git a/arch/riscv/boot/dts/bouffalolab/bl808.dtsi b/arch/riscv/boot/dts/bouffalolab/bl808.dtsi
index 15a4a8b9a39c..fd1261e0cc1f 100644
--- a/arch/riscv/boot/dts/bouffalolab/bl808.dtsi
+++ b/arch/riscv/boot/dts/bouffalolab/bl808.dtsi
@@ -128,8 +128,18 @@ BFLB_IPC_DEVICE_SDHCI
 		};
 
 
-		ehci0: usb@20072000 {
-			compatible = "generic-ehci";
+		usb0: usb_hcd@20072000 {
+			compatible = "faraday,fotg210_hcd";
+			reg = <0x20072000 0x1000>;
+			interrupts-extended = <&ipclic BFLB_IPC_SOURCE_M0
+						       BFLB_IPC_DEVICE_USB
+						       IRQ_TYPE_EDGE_RISING>;
+			clocks = <&xtal>;
+			status = "disabled";
+		};
+
+		usb1: usb_udc@20072000 {
+			compatible = "faraday,fotg210_udc";
 			reg = <0x20072000 0x1000>;
 			interrupts-extended = <&ipclic BFLB_IPC_SOURCE_M0
 						       BFLB_IPC_DEVICE_USB
-- 
2.34.1

