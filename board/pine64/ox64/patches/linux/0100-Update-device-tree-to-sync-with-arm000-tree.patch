From adae639244ae0dc0dbc1accd4171f56eaf9bdc5c Mon Sep 17 00:00:00 2001
From: "Grant T. Olson" <kgo@grant-olson.net>
Date: Sun, 19 Feb 2023 15:25:26 -0500
Subject: [PATCH 100/104] Update device tree to sync with arm000 tree

---
 .../dts/bouffalolab/bl808-pine64-ox64.dts     |  8 ++++++
 .../boot/dts/bouffalolab/bl808-sipeed-m1s.dts |  8 ++++++
 arch/riscv/boot/dts/bouffalolab/bl808.dtsi    | 28 +++++++++++++++++++
 3 files changed, 44 insertions(+)

diff --git a/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts b/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts
index 0d8ba867ad32..420d3e40e3f4 100644
--- a/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts
+++ b/arch/riscv/boot/dts/bouffalolab/bl808-pine64-ox64.dts
@@ -62,3 +62,11 @@ &sdhci0 {
 &ipclic {
 	status = "okay";
 };
+
+&ehci0 {
+	status = "okay";
+};
+
+&enet0 {
+	status = "okay";
+};
diff --git a/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts b/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts
index 1d09c060ab41..155ebdbfc411 100644
--- a/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts
+++ b/arch/riscv/boot/dts/bouffalolab/bl808-sipeed-m1s.dts
@@ -72,3 +72,11 @@ &sdhci0 {
 &ipclic {
 	status = "okay";
 };
+
+&ehci0 {
+	status = "okay";
+};
+
+&enet0 {
+	status = "okay";
+};
diff --git a/arch/riscv/boot/dts/bouffalolab/bl808.dtsi b/arch/riscv/boot/dts/bouffalolab/bl808.dtsi
index b217bff9ae5c..15a4a8b9a39c 100644
--- a/arch/riscv/boot/dts/bouffalolab/bl808.dtsi
+++ b/arch/riscv/boot/dts/bouffalolab/bl808.dtsi
@@ -52,6 +52,13 @@ sdh: sdh-clk {
 		#clock-cells = <0>;
 	};
 
+	enet: enet-clk {
+		compatible = "fixed-clock";
+		clock-frequency = <50000000>;
+		clock-output-names = "enet";
+		#clock-cells = <0>;
+	};
+
 	soc {
 		compatible = "simple-bus";
 		ranges;
@@ -120,6 +127,27 @@ BFLB_IPC_DEVICE_SDHCI
 			status = "disabled";
 		};
 
+
+		ehci0: usb@20072000 {
+			compatible = "generic-ehci";
+			reg = <0x20072000 0x1000>;
+			interrupts-extended = <&ipclic BFLB_IPC_SOURCE_M0
+						       BFLB_IPC_DEVICE_USB
+						       IRQ_TYPE_EDGE_RISING>;
+			clocks = <&xtal>;
+			status = "disabled";
+		};
+
+		enet0: emac@20070000 {
+			compatible = "opencores,ethoc";
+			reg = <0x20070000 0x1000>;
+			interrupts-extended = <&ipclic BFLB_IPC_SOURCE_M0
+						       BFLB_IPC_DEVICE_EMAC
+						       IRQ_TYPE_EDGE_RISING>;
+			clocks = <&enet>;
+			status = "disabled";
+		};
+
 		ipclic: mailbox@30005000 {
 			compatible = "bflb,bl808-ipc";
 			reg = <0x30005000 0x20>,
-- 
2.34.1

